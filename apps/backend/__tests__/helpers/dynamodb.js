"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.TABLE_NAME = exports.docClient = void 0;
exports.seedNote = seedNote;
exports.clearTable = clearTable;
exports.createTestNote = createTestNote;
const client_dynamodb_1 = require("@aws-sdk/client-dynamodb");
const lib_dynamodb_1 = require("@aws-sdk/lib-dynamodb");
const client = new client_dynamodb_1.DynamoDBClient({
    endpoint: 'http://localhost:8000',
    region: 'local-env',
    credentials: {
        accessKeyId: 'fakeMyKeyId',
        secretAccessKey: 'fakeSecretAccessKey',
    },
});
exports.docClient = lib_dynamodb_1.DynamoDBDocumentClient.from(client);
exports.TABLE_NAME = process.env.TABLE_NAME || 'test-notes-table';
async function seedNote(note) {
    await exports.docClient.send(new lib_dynamodb_1.PutCommand({
        TableName: exports.TABLE_NAME,
        Item: note,
    }));
}
async function clearTable() {
    const result = await exports.docClient.send(new lib_dynamodb_1.ScanCommand({
        TableName: exports.TABLE_NAME,
    }));
    if (result.Items && result.Items.length > 0) {
        await Promise.all(result.Items.map((item) => exports.docClient.send(new lib_dynamodb_1.DeleteCommand({
            TableName: exports.TABLE_NAME,
            Key: {
                PK: item.PK,
                SK: item.SK,
            },
        }))));
    }
}
function createTestNote(userId, noteId, overrides = {}) {
    const now = new Date().toISOString();
    return {
        PK: `USER#${userId}`,
        SK: `NOTE#${noteId}`,
        GSI_PK: `USER#${userId}`,
        GSI_SK: `${now}#${noteId}`,
        id: noteId,
        userId,
        title: 'Test Note',
        content: 'Test content',
        createdAt: now,
        updatedAt: now,
        ...overrides,
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZHluYW1vZGIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJkeW5hbW9kYi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFrQ0EsNEJBT0M7QUFFRCxnQ0FzQkM7QUFFRCx3Q0FtQkM7QUF0RkQsOERBQTBEO0FBQzFELHdEQUsrQjtBQUUvQixNQUFNLE1BQU0sR0FBRyxJQUFJLGdDQUFjLENBQUM7SUFDaEMsUUFBUSxFQUFFLHVCQUF1QjtJQUNqQyxNQUFNLEVBQUUsV0FBVztJQUNuQixXQUFXLEVBQUU7UUFDWCxXQUFXLEVBQUUsYUFBYTtRQUMxQixlQUFlLEVBQUUscUJBQXFCO0tBQ3ZDO0NBQ0YsQ0FBQyxDQUFDO0FBRVUsUUFBQSxTQUFTLEdBQUcscUNBQXNCLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBRWhELFFBQUEsVUFBVSxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsVUFBVSxJQUFJLGtCQUFrQixDQUFDO0FBZWhFLEtBQUssVUFBVSxRQUFRLENBQUMsSUFBYztJQUMzQyxNQUFNLGlCQUFTLENBQUMsSUFBSSxDQUNsQixJQUFJLHlCQUFVLENBQUM7UUFDYixTQUFTLEVBQUUsa0JBQVU7UUFDckIsSUFBSSxFQUFFLElBQUk7S0FDWCxDQUFDLENBQ0gsQ0FBQztBQUNKLENBQUM7QUFFTSxLQUFLLFVBQVUsVUFBVTtJQUM5QixNQUFNLE1BQU0sR0FBRyxNQUFNLGlCQUFTLENBQUMsSUFBSSxDQUNqQyxJQUFJLDBCQUFXLENBQUM7UUFDZCxTQUFTLEVBQUUsa0JBQVU7S0FDdEIsQ0FBQyxDQUNILENBQUM7SUFFRixJQUFJLE1BQU0sQ0FBQyxLQUFLLElBQUksTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUM7UUFDNUMsTUFBTSxPQUFPLENBQUMsR0FBRyxDQUNmLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FDeEIsaUJBQVMsQ0FBQyxJQUFJLENBQ1osSUFBSSw0QkFBYSxDQUFDO1lBQ2hCLFNBQVMsRUFBRSxrQkFBVTtZQUNyQixHQUFHLEVBQUU7Z0JBQ0gsRUFBRSxFQUFFLElBQUksQ0FBQyxFQUFFO2dCQUNYLEVBQUUsRUFBRSxJQUFJLENBQUMsRUFBRTthQUNaO1NBQ0YsQ0FBQyxDQUNILENBQ0YsQ0FDRixDQUFDO0lBQ0osQ0FBQztBQUNILENBQUM7QUFFRCxTQUFnQixjQUFjLENBQzVCLE1BQWMsRUFDZCxNQUFjLEVBQ2QsWUFBK0IsRUFBRTtJQUVqQyxNQUFNLEdBQUcsR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBQ3JDLE9BQU87UUFDTCxFQUFFLEVBQUUsUUFBUSxNQUFNLEVBQUU7UUFDcEIsRUFBRSxFQUFFLFFBQVEsTUFBTSxFQUFFO1FBQ3BCLE1BQU0sRUFBRSxRQUFRLE1BQU0sRUFBRTtRQUN4QixNQUFNLEVBQUUsR0FBRyxHQUFHLElBQUksTUFBTSxFQUFFO1FBQzFCLEVBQUUsRUFBRSxNQUFNO1FBQ1YsTUFBTTtRQUNOLEtBQUssRUFBRSxXQUFXO1FBQ2xCLE9BQU8sRUFBRSxjQUFjO1FBQ3ZCLFNBQVMsRUFBRSxHQUFHO1FBQ2QsU0FBUyxFQUFFLEdBQUc7UUFDZCxHQUFHLFNBQVM7S0FDYixDQUFDO0FBQ0osQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IER5bmFtb0RCQ2xpZW50IH0gZnJvbSAnQGF3cy1zZGsvY2xpZW50LWR5bmFtb2RiJztcbmltcG9ydCB7XG4gIER5bmFtb0RCRG9jdW1lbnRDbGllbnQsXG4gIFB1dENvbW1hbmQsXG4gIERlbGV0ZUNvbW1hbmQsXG4gIFNjYW5Db21tYW5kLFxufSBmcm9tICdAYXdzLXNkay9saWItZHluYW1vZGInO1xuXG5jb25zdCBjbGllbnQgPSBuZXcgRHluYW1vREJDbGllbnQoe1xuICBlbmRwb2ludDogJ2h0dHA6Ly9sb2NhbGhvc3Q6ODAwMCcsXG4gIHJlZ2lvbjogJ2xvY2FsLWVudicsXG4gIGNyZWRlbnRpYWxzOiB7XG4gICAgYWNjZXNzS2V5SWQ6ICdmYWtlTXlLZXlJZCcsXG4gICAgc2VjcmV0QWNjZXNzS2V5OiAnZmFrZVNlY3JldEFjY2Vzc0tleScsXG4gIH0sXG59KTtcblxuZXhwb3J0IGNvbnN0IGRvY0NsaWVudCA9IER5bmFtb0RCRG9jdW1lbnRDbGllbnQuZnJvbShjbGllbnQpO1xuXG5leHBvcnQgY29uc3QgVEFCTEVfTkFNRSA9IHByb2Nlc3MuZW52LlRBQkxFX05BTUUgfHwgJ3Rlc3Qtbm90ZXMtdGFibGUnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFRlc3ROb3RlIHtcbiAgUEs6IHN0cmluZztcbiAgU0s6IHN0cmluZztcbiAgR1NJX1BLOiBzdHJpbmc7XG4gIEdTSV9TSzogc3RyaW5nO1xuICBpZDogc3RyaW5nO1xuICB1c2VySWQ6IHN0cmluZztcbiAgdGl0bGU6IHN0cmluZztcbiAgY29udGVudDogc3RyaW5nO1xuICBjcmVhdGVkQXQ6IHN0cmluZztcbiAgdXBkYXRlZEF0OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZWVkTm90ZShub3RlOiBUZXN0Tm90ZSk6IFByb21pc2U8dm9pZD4ge1xuICBhd2FpdCBkb2NDbGllbnQuc2VuZChcbiAgICBuZXcgUHV0Q29tbWFuZCh7XG4gICAgICBUYWJsZU5hbWU6IFRBQkxFX05BTUUsXG4gICAgICBJdGVtOiBub3RlLFxuICAgIH0pXG4gICk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjbGVhclRhYmxlKCk6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCByZXN1bHQgPSBhd2FpdCBkb2NDbGllbnQuc2VuZChcbiAgICBuZXcgU2NhbkNvbW1hbmQoe1xuICAgICAgVGFibGVOYW1lOiBUQUJMRV9OQU1FLFxuICAgIH0pXG4gICk7XG5cbiAgaWYgKHJlc3VsdC5JdGVtcyAmJiByZXN1bHQuSXRlbXMubGVuZ3RoID4gMCkge1xuICAgIGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgcmVzdWx0Lkl0ZW1zLm1hcCgoaXRlbSkgPT5cbiAgICAgICAgZG9jQ2xpZW50LnNlbmQoXG4gICAgICAgICAgbmV3IERlbGV0ZUNvbW1hbmQoe1xuICAgICAgICAgICAgVGFibGVOYW1lOiBUQUJMRV9OQU1FLFxuICAgICAgICAgICAgS2V5OiB7XG4gICAgICAgICAgICAgIFBLOiBpdGVtLlBLLFxuICAgICAgICAgICAgICBTSzogaXRlbS5TSyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSlcbiAgICAgICAgKVxuICAgICAgKVxuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVRlc3ROb3RlKFxuICB1c2VySWQ6IHN0cmluZyxcbiAgbm90ZUlkOiBzdHJpbmcsXG4gIG92ZXJyaWRlczogUGFydGlhbDxUZXN0Tm90ZT4gPSB7fVxuKTogVGVzdE5vdGUge1xuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG4gIHJldHVybiB7XG4gICAgUEs6IGBVU0VSIyR7dXNlcklkfWAsXG4gICAgU0s6IGBOT1RFIyR7bm90ZUlkfWAsXG4gICAgR1NJX1BLOiBgVVNFUiMke3VzZXJJZH1gLFxuICAgIEdTSV9TSzogYCR7bm93fSMke25vdGVJZH1gLFxuICAgIGlkOiBub3RlSWQsXG4gICAgdXNlcklkLFxuICAgIHRpdGxlOiAnVGVzdCBOb3RlJyxcbiAgICBjb250ZW50OiAnVGVzdCBjb250ZW50JyxcbiAgICBjcmVhdGVkQXQ6IG5vdyxcbiAgICB1cGRhdGVkQXQ6IG5vdyxcbiAgICAuLi5vdmVycmlkZXMsXG4gIH07XG59XG4iXX0=